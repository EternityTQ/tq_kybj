---
title: 4.1 指令系统
---

第四章核心：控制器的功能

## 1. 指令集体系结构

指令集体系结构(ISA)所规定的内容主要包括：

1. 指令格式，指令寻址方式，操作类型，以及每种操作对应的操作数的相应规定
2. 操作数的类型，操作数寻址方式，以及是按大端方式还是按小端方式存放
3. 程序可访问的寄存器编号、个数和位数，存储空间的大小和编址方式
4. 指令执行过程的控制方式等，包括程序计数器、条件码定义等

## 2. 指令的基本格式
指令：是指示计算机执行某种操作的命令，是计算机运行的最小功能单位

一台计算机的所有指令的集合构成该机的指令系统，也称为指令集

一条指令通常包括操作码字段和地址码字段两个部分：

操作码指出该指令应该执行什么操作以及具有什么功能

地址码给出<u>被操作</u>的信息(指令或数据)的地址

一条指令可能包括多个地址码或没有地址码

指令的地址由PC给出


## 3. 按地址码数目分类


### 1. 零地址指令

OP

1. 不需要操作数，如空操作、停机、关中断等指令

2. 堆栈计算机，两个操作数隐含存放在栈顶和次栈顶，计算结果压回栈顶

### 2. 一地址指令

OP A~1~

1. 只需要单操作数，如加一，减一，取反等

指令含义：$OP(A_1)\to A_1$

完成一条指令需要3次访存 取指→读A1→写A1

1. 需要两个操作数，但其中一个操作数隐含在某个寄存器中(例如隐含在ACC)

指令含义：$(ACC)OP(A_1)\to ACC$

完成一条指令需要2次访存：取指→读A1


注：$A_1$指某个主存地址，类似C语言指针

$(A_1)$表示其所指向的地址的内容

### 3. 二、三地址指令

OP A~1~(目的操作数) A~2~(源操作数)

常用于需要两个操作数的算术运算、逻辑运算相关指令

指令含义：$(A_1)OP(A_2)\to A_1$

完成一条指令需要访存4次：

三地址指令会显式的给出结果存放的地址A~3~

指令含义：$(A_1)OP(A_2)\to A_3$

### 4. 四地址指令

A~4~表示下一条将要执行指令的地址

完成一条指令需要访存4次

指令含义：$(A_1)OP(A_2)\to A_3$

正常情况：取指令后，PC+1，指向下一条指令

四地址指令：直接修改PC的值


:::tip
n位地址码的直接寻址范围=$2^n$

若指令总长度固定不变，则地址码数量越多，寻址能力越差
:::


## 4. 按指令长度分类

指令字长：一条指令的总长度(可能会变)

半字长指令、单字长指令、双字长指令——指令长度是机器字长的多少倍

指令字长关系到取指令所需时间

定长指令子结构&变长指令子结构

## 5. 按操作码长度分类

定长操作码：指令系统中所有指令的操作码长度都相同

其控制器的译码电路设计简单，但灵活性较低

可变长操作码：操作码长度可变

控制器的译码电路设计复杂，但灵活性较高

## 6. 按操作类型分类


### 1. 数据传送(数据传送类)
LOAD 作用：把存储器的数据放到寄存器中

STORE 把寄存器的数据放到存储器中

### 2. 算术逻辑操作(运算类)
算术：加减乘除

### 3 移位操作(运算类)
算术移位、逻辑移位、循环移位

### 4. 转移操作(程序控制类)

无条件转移 JMP

条件转移 JZ：结果为0 JO：结果溢出 JC：结果有进位

调用和返回 CALL和RETURN

陷阱(TRAP)与陷阱指令

### 5. 输入输出操作(IO类)

CPU寄存器和IO端口之间的数据传送

## 7. 扩展操作码指令格式

指令由操作码和若干个地址码组成

定长指令字结构+可变长操作码→扩展操作码指令格式

不同地址数的指令使用不同长度的操作码

例如：操作码前4位0000\~1110用来标识三地址指令，操作码前8位1111

 0000\~1111 1110用来扩展表示二地址指令

类似地，一地址指令有15条，零地址指令有16条

设计扩展操作码指令格式时，注意以下两点：

1. ==不允许短码是长码的前缀==

2. 各指令的操作码一定不能重复

通常情况下：对使用频率较高的指令，分配较短的操作阿妈；对使用频率较低的指令，分配较长的操作码，从而尽可能减少指令译码和分析的时间

设地址长度为n，上一层留出m种状态，则下一层可扩展出$m×2^n$种状态

需要表示$2^n-m$条指令，就用$n$个比特位





