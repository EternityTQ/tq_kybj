---
title: 5.2 指令执行过程
---

## 1. 指令周期

指令周期：CPU从主存中每取出并执行一条指令所需的全部时间

指令周期常常用若干机器周期来表示，机器周期又叫CPU周期

一个机器周期又包含若干时钟周期，==是CPU操作的最基本单位==

![](image-2.png =500x)

取指令需要访存，消耗大量时间；移码不需要很多时间

执行指令也可能需要访存

所以都占一个CPU周期

每个指令周期内的机器周期数可以不等；每个机器周期内的节拍数也可以不等

具有间接寻址的指令，还存在间址周期

有些指令带有中断周期，中断请求时，CPU进入中断响应状态

![](image-3.png =400x)

四个工作周期都有CPU访存操作，只是目的不同

取指周期：取指令

间址周期：取有效地址

执行周期：取操作数

中断周期：保存程序断点

:::tip
CPU会根据不同的周期来判断取出的是指令还是数据
:::

### 1. 取指周期

1. 当前指令地址送至MAR


记作 (PC)→MAR

2. CU发出控制信号，经控制总线传到主存，这里是读信号，记作 1→R

3. 将MAR所指主存中的内容经数据总线送入MDR

记作M(MAR)→MDR

4. 将MDR的内容(此时是指令)送入IR

记作(MDR)→IR

>IR：指令寄存器

5. CU发出控制信号，形成下一条地址

记作(PC)+1→PC

### 2. 间址周期

1. 将指令的地址码送入MAR

记作 Ad(IR)→MAR

或者 Ad(MDR)→MAR

2. CU发出控制信号，启动主存做读操作

3. 将MAR所指主存中的内容经数据总线送入MDR

记作M(MAR)→MDR

4. 将有效地址送至指令的地址码字段，进行拼接

记作(MDR)→Ad(IR)

### 3. 执行周期

没有统一的数据流向

### 4. 中断周期

中断：暂停当前任务去完成其他任务

为了能够恢复当前任务，需要保存断点

一般使用堆栈来保存断点

进栈操作：先修改指针，后存入数据

1. CU控制将SP减1，修改后的地址送入MAR

记作(SP)-1→SP，(SP)→MAR

本质上是将断点存入某个存储单元，假设其地址为a，故可记作a→MAR

2. CU发出控制信号，启动主存做写操作，记作1→W

3. 将断点送入MDR

记作(PC)→MDR

4. CU控制将中断服务程序的入口地址送入PC

:::tip
FE 取指周期

IND 间址周期

EX 执行周期

INT 中断周期
:::

## 2. 指令执行方案

### 2.1 单指令周期

对于任何指令，都需要将其指令周期延长到与最长指令的指令周期相等

对所有指令都选用相同的执行时间来完成，控制电路设计简单

指令之间串行执行；指令周期取决于执行时间最长的指令的执行时间

缺点：对于本可以在更短时间内完成的指令，需要更长的周期，降低运行速度

:::tip
单指令周期下，每个指令的执行只有一个时钟周期，在一个时钟周期内的控制信号不会变化
:::

### 2.2 多指令周期

对于不同类型的指令选用不同的执行步骤来完成

指令之间串行执行，可选择不同个数的时钟周期来完成不同指令的执行过程

需要更复杂的硬件设计

### 2.3 流水线方案

在每一个时钟周期启动一条指令，尽量让多条指令同时运行，但各自处在不同的执行步骤中。

指令之间并行执行































